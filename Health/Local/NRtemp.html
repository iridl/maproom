<INGRID>
 SOURCES .NOAA .NCEP-NCAR .CDAS-1 .DAILY .Intrinsic .PressureLevel .temp
%SOURCES .NOAA .NCEP .CPC .FEWS .TEN-DAY .RFEv2 .est_prcp
mimeheader
pop
</INGRID>
<html>
<head><title>NASA-ROSES Local Temperature</title>
<link REL=stylesheet TYPE="text/css" HREF="/site.html">
</head>
<body bgcolor="#ffffff" link="#993333" vlink="#993333" alink="#FF0000">
<INGRID>leftmenu</INGRID>
<form action=NRtemp.html>

<INGRID>
saveLanguage

/onebox {2 index 1 index {.name cvx exec first pointwidth 2 copy sub 3 1 roll add 3 -1 roll pop}forall counttoobject 1 add -1 roll pop {mystream mygrids xlo xhi ylo yhi}inputs mystream mygrids 0 get xlo xhi RANGE
dup 0 replaceNaN exch
 mygrids 1 get ylo yhi RANGE mygrids 0 get xlo xhi definite-integral mygrids 1 get ylo yhi definite-integral 
exch dataflag
 mygrids 1 get ylo yhi RANGE mygrids 0 get xlo xhi definite-integral mygrids 1 get ylo yhi definite-integral 
.5	normalize
1output}def

/onebox {2 index 1 index {.name cvx exec first pointwidth 2 copy sub 3 1 roll add 3 -1 roll pop}forall counttoobject 1 add -1 roll pop {mystream mygrids xlo xhi ylo yhi}inputs mystream 
mygrids 0 get xlo xhi add 2. div VALUE
 mygrids 1 get ylo yhi add 2. div VALUE
1output}def

%SOURCES .NOAA .NCEP .CPC .FEWS .TEN-DAY .RFEv2 .est_prcp
 SOURCES .NOAA .NCEP-NCAR .CDAS-1 .DAILY .Intrinsic .PressureLevel .temp
 (Celsius_scale) unitconvert
  a:
    X -21.2 0.1 56.2 GRID
    Y -16.2 0.1 41.2 GRID
    :a:
     P 1000 VALUE
     X -20 55 RANGE
     Y -15 40 RANGE
     T (1 Jan 1979) last RANGE
     dekadalAverage :a
   [X Y]regridAverage

/avgbyentity null 4 object def

avgbyentity /Country
 {
IRIDB
(select gid,the_geom,cntry_name as name1,centroid(the_geom) as center,distance(centroid(the_geom),GeometryFromText( 'POINT(YYYY)',4326 )) from esri2002_national where intersects(the_geom,GeometryFromText( 'POINT(XXXX)',4326 )) ORDER BY distance(centroid(the_geom),GeometryFromText( 'POINT(YYYY)',4326 )) LIMIT 1)

(XXXX) rsearch pop nip
 X WWWinfo .FORMinfo .map .X .plotvalue readunits  s== nip
( )
 Y WWWinfo .FORMinfo .map .Y .plotvalue readunits  s== nip
3array astore concat
exch
3array astore concat
2 {
(YYYY) rsearch pop nip
 X WWWinfo .FORMinfo .map .X .plotvalue readunits  s== nip
( )
 Y WWWinfo .FORMinfo .map .Y .plotvalue readunits  s== nip
3array astore concat
exch
3array astore concat
} repeat
openquery
/gendistrictinfo WWWinfo !
pop
WWWinfo .gendistrictinfo .the_geom [X Y] weighted-average
  } put

avgbyentity /province
  {
  IRIDB
  (select feature_id,the_geom,country_na as name1,prov_na as name2,centroid(the_geom) as center,distance(centroid(the_geom),GeometryFromText( 'POINT(YYYY)',4326 )) from mews_prov where intersects(the_geom,GeometryFromText( 'POINT(XXXX)',4326 )) ORDER BY distance(centroid(the_geom),GeometryFromText( 'POINT(YYYY)',4326 )) LIMIT 1)

  (XXXX) rsearch pop nip
   X WWWinfo .FORMinfo .map .X .plotvalue readunits  s== nip
  ( )
   Y WWWinfo .FORMinfo .map .Y .plotvalue readunits  s== nip
  3array astore concat
  exch
  3array astore concat
  2 {
  (YYYY) rsearch pop nip
   X WWWinfo .FORMinfo .map .X .plotvalue readunits  s== nip
  ( )
   Y WWWinfo .FORMinfo .map .Y .plotvalue readunits  s== nip
  3array astore concat
  exch
  3array astore concat
  } repeat
  openquery
  /gendistrictinfo WWWinfo !
  pop
  WWWinfo .gendistrictinfo .the_geom [X Y] weighted-average
  } put

avgbyentity /district
  {

%{ 
%dup (district) eq
%{ 
IRIDB
(select gid,the_geom,country_na as name1,prov_na as name2,dist_na as name3,centroid(the_geom) as center,distance(centroid(the_geom),GeometryFromText( 'POINT(YYYY)',4326 )) from mews_dist where intersects (the_geom,GeometryFromText('POINT(XXXX)',4326)) ORDER BY distance(centroid(the_geom),GeometryFromText( 'POINT(YYYY)',4326 )) LIMIT 1 )

(XXXX) rsearch pop nip
 X WWWinfo .FORMinfo .map .X .plotvalue readunits  s== nip
( )
 Y WWWinfo .FORMinfo .map .Y .plotvalue readunits  s== nip
3array astore concat
exch
3array astore concat 
2 {
(YYYY) rsearch pop nip
 X WWWinfo .FORMinfo .map .X .plotvalue readunits  s== nip
( )
 Y WWWinfo .FORMinfo .map .Y .plotvalue readunits  s== nip
3array astore concat
exch
3array astore concat 
} repeat
openquery
/gendistrictinfo WWWinfo !
pop
WWWinfo .gendistrictinfo .the_geom [X Y] weighted-average
} put

WWWinfo .FORMinfo .map .Y /step getknown

{ % +

 avgbyentity 1 index getknown

 { % -
   exec
 } % -.

 { % *
   interp
   dup
   Y .step gt
   {
   exch
     Y 2 index splitstreamgrid
     X 2 index splitstreamgrid
     [X Y]0.5 average
     X2 /X renameGRID
     Y2 /Y renameGRID
    nip
   }
   {pop
   } ifelse
   Y /step WWWinfo .FORMinfo .map .Y .step interp def pop
 } ifelse % *.

} % +.

{
Y .step /step WWWinfo .FORMinfo .map .Y !
}
ifelse

dup /Y known {Y /step step def pop
X WWWinfo .FORMinfo .map .X .plotvalue VALUE
Y WWWinfo .FORMinfo .map .Y .plotvalue VALUE
} if




% need climo. here
% home .grover .EMILY .Analyses .RFEv2Avg .avg

 home .mbell .IRI .MD .maproom .Analyses .Reanalysis .Meningitis .clim .temp


WWWinfo .FORMinfo .map .Y .step (Country) eq
WWWinfo .FORMinfo .map .Y .step (province) eq or
WWWinfo .FORMinfo .map .Y .step (district) eq or

{
X -20 55 RANGE
Y -15 40 RANGE
WWWinfo .gendistrictinfo .the_geom [X Y] weighted-average
}
{[X Y] onebox} ifelse


exch  
</INGRID>

<center><table width="580"><tbody><tr valign="top"><td align="left">

<table cellpadding="4" cellspacing="4" bgcolor="#ffffff"><tbody><tr bgcolor="#f0f0f0"><td>
<INGRID>
SOURCES .WORLDBATH .bath

WWWinfo .FORMinfo .map .Y .step (Country) eq
WWWinfo .FORMinfo .map .Y .step (province) eq or
WWWinfo .FORMinfo .map .Y .step (district) eq or

{WWWinfo .gendistrictinfo a: .the_geom :a: .center :a 
X Y fig: lightgrey mask grey mews_prov black countries_gaz red fill  red geometrysmallpushpins :fig
}
{
1 index a: .X first pointwidth .5 mul sub nip 
:a: .Y first pointwidth .5 mul sub nip
 :a: .X first pointwidth .5 mul add nip 
:a: .Y first pointwidth .5 mul add nip :a
georect
2 index a: .X .first :a: .Y .first :a
togeopoint 
a: .lon :a: .lat :a 
X Y fig: lightgrey mask grey mews_prov black countries_gaz red fill  red smallpushpins :fig
} ifelse

 /plotaxislength 120 psdef /plotborder 0 psdef
/plotbordertop 8 psdef
/plotborderright 8 psdef
/plotborderleft 8 psdef
/plotborderbottom 8 psdef
/antialias true psdef
/map imagelink
</INGRID></td><td align="left">
<font face="Helvetical,Arial" point-size=10pt size=-1>
Observations for:<br> 

<b><INGRID>

WWWinfo .FORMinfo .map .Y .step (Country) eq

{
  WWWinfo .gendistrictinfo

  [ name1 ] {reserverealization} forall

  ()
  [
  name1 getrealization
  ] { dup (N.A.) eq {pop}{exch print print (, )}ifelse} forall
  pop
  pop
}
{

 WWWinfo .FORMinfo .map .Y .step (province) eq 
 
 {
   WWWinfo .gendistrictinfo

   [ name1 name2 ] {reserverealization} forall

   ()
   [
   name2 getrealization
   name1 getrealization
   ] { dup (N.A.) eq {pop}{exch print print (, )}ifelse} forall
   pop
   pop
 }
 {

  WWWinfo .FORMinfo .map .Y .step (district) eq 

  {
    WWWinfo .gendistrictinfo
    [ name1 name2 name3 ] {reserverealization} forall
    ()
    [
    name3 getrealization 
    name2 getrealization 
    name1 getrealization 
    ] { dup (N.A.) eq {pop}{exch print print (, )}ifelse} forall
    pop
    pop
  }
  {
   X first printunits pop
   (, ) print
   Y first printunits pop
   (<br> ~ )print
   Y .step
   10000 90. div mul floor cvi dup ==ns (x) print ==ns ( km) print
  } ifelse
 } ifelse
} ifelse

</INGRID></b></font>
</td>
<INGRID>
showmenu? {
(<td bgcolor=white cellpadding=12>)print
(map.Y.step) WWWinfo .FORMinfo .map .Y .step
 
%dup (district) ne {interp} if startselect

 dup (province) eq
 {
 }
 {
  dup (district) eq
  {
  }
  {
   dup (Country) eq
   {
   }
   {interp
   } ifelse
  } ifelse
 } ifelse
startselect
.1 (11km) valueoption
.3 (33km) valueoption
.5 (55km) valueoption
1. (111km) valueoption
(Country) (Country) valueoption
(province) (Province) valueoption
(district) (District) valueoption
endselect
(<input name="map.X.plotvalue" size=8 value=")print
WWWinfo .FORMinfo .map .X .plotvalue print(">\n) print
(<input name="map.Y.plotvalue" size=8 value=")print WWWinfo .FORMinfo .map .Y .plotvalue print(">\n)print
(<input type="hidden" name="map.X.units" value=")print WWWinfo .FORMinfo .map .X .units print(">\n)print
(<input type="hidden" name="map.Y.units" value=")print WWWinfo .FORMinfo .map .Y .units print(">\n)print
(<input type="hidden" name="map.X.plotfirst" value=")print WWWinfo .FORMinfo .map .X .plotfirst print(">\n)print
(<input type="hidden" name="map.Y.plotfirst" value=")print WWWinfo .FORMinfo .map .Y .plotfirst print(">\n)print
(<input type="hidden" name="map.X.plotlast" value=")print WWWinfo .FORMinfo .map .X .plotlast print(">\n)print
(<input type="hidden" name="map.Y.plotlast" value=")print WWWinfo .FORMinfo .map .Y .plotlast print(">\n)print
(<input type=submit value="Generate new time series">) print
(</td>)print
} if
</INGRID>
</tr></tbody></table>
<table border cellpadding="6" cellspacing="4" bgcolor="#ffffff"><tbody><tr valign="top"><td width="50%"  bgcolor=#F0F8FF>
<font face="Helvetical,Arial" point-size=9pt size=-1>
<b>a) </b><br>
</font>

<center>
<a href="/<INGRID> dup dataseturl</INGRID>/DATA/null/null/RANGE/%5BT%5DREORDER/T/fig:/line/:fig/figviewer.html?my.help=more+options&map.temp.units=unitless&map.url=&map.domain=+%7B+T+last+3650.+sub+last+plotrange+%7D&map.domainparam=+/plotaxislength+250+psdef+/plotborder+72+psdef+/XOVY+null+psdef&map.zoom=Zoom&map.T.plotfirst=last+3650.+sub&map.T.units=days+since+1960-01-01&map.T.plotlast=&map.plotaxislength=432&map.plotborder=72&map.fnt=Helvetica&map.fntsze=12&map.XOVY=auto&map.color_smoothing=1&map.iftime=25&map.mftime=25&map.fftime=200" OnMouseOver="self.status='Click here to explore the data';return true">
<img src="/<INGRID> dup dataseturl</INGRID>/toNaN/DATA/null/null/RANGE/%5BT%5DREORDER/T/fig:/line/:fig/+/T/last/3650./sub/last/plotrange+//plotborder+72+psdef//plotbordertop+15+psdef//plotborderbottom+62+psdef//plotaxislength+250+psdef//XOVY+null+psdef+.gif" NOSAVE border=0 ALT="Multi-year temperature time series" title="Multi-year temperature time series" width=322 height=197</a>
</center>
<font size=-1><br><a href="/<INGRID> dup dataseturl</INGRID>/T+exch/2+ncoltable.html?tabopt.N=3&tabopt.1=text&tabopt.2=text&tabopt.3=markNaN&NaNmarker=NaN&tabtype=html">Data in this graph</a></font>

</td><td height="200" bgcolor="#F0F8FF" width="50%">
<font face="Helvetical,Arial" point-size=9pt size=-1>
<b>b) </b><br>
</font>
<center>

<a href="/<INGRID> dup dataseturl</INGRID>/DATA/null/null/RANGE//plotlast/200/def//fullname/%28Temperature%29def/<INGRID> 1 index dataseturl </INGRID>%5BT%5D2/SM121/T/2/index/.T/a:/.first/cvsunits/:a:/.last/cvsunits/:a/RANGE/T/2/index/.T/replaceGRID//fullname/%281979-2008%20Average%29def/2/copy/maskgt/1/index/T/fig:/blue/deltabars/brown/deltabars/|/black/line/grey/line/:fig/figviewer.html?my.help=more+options&map.url=&map.domain=+%7B+/T+last+3650.+sub+last+plotrange+%7D&map.domainparam=+/plotaxislength+250+psdef+/plotborder+72+psdef+/XOVY+null+psdef&map.zoom=Zoom&map.T.plotfirst=last+3650.+sub&map.T.units=days+since+1960-01-01&map.T.plotlast=&map.plotaxislength=432" OnMouseOver="self.status='Click here to explore the data';return true">

<img src="/<INGRID> dup dataseturl</INGRID>/DATA/null/null/RANGE//plotlast/45.0/def//fullname/%28Temperature%29def/<INGRID> 1 index dataseturl </INGRID>%5BT%5D2/SM121/T/2/index/.T/a:/.first/cvsunits/:a:/.last/cvsunits/:a/RANGE/T/2/index/.T/replaceGRID//fullname/%281979-2008%20Average%29def/2/copy/maskgt/1/index/T/fig:/blue/deltabars/brown/deltabars/|/black/line/grey/line/:fig/+/T/last/3650./sub/last/plotrange+//plotborder+72+psdef//plotbordertop+20+psdef//plotborderbottom+62+psdef//plotaxislength+250+psdef//XOVY+null+psdef+.gif" NOSAVE border=0 ALT="Multi-year observed vs. average temperature" title="Multi-year observed vs. average temperature" width=322 height=197></a>
</center>
<font size=-1><br><a href="/<INGRID> dup dataseturl</INGRID>/DATA/null/null/RANGE//plotlast/200/def/<INGRID> 1 index dataseturl </INGRID>%5BT%5D2/SM121/T/2/index/.T/a:/.first/cvsunits/:a:/.last/cvsunits/:a/RANGE/T/2/index/.T/replaceGRID//fullname(1979-2008%20Average)def//long_name/%281979-2008%20Average%20Temperature%29def/T/3/1/roll/3+ncoltable.html?tabopt.N=4&tabopt.1=text&tabopt.2=text&tabopt.3=text&tabopt.4=markNaN&NaNmarker=NaN&tabtype=html&eol=LF+%28unix%29">Data in this graph</a></font>
</td></tr><tr valign="top"><td width="50%" bgcolor="#F0F8FF">

<font face="Helvetical,Arial" point-size=9pt size=-1>
<b>c) </b><br>
</font>
<center>
<a href="/<INGRID> dup dataseturl</INGRID>/T/2/copy//pointwidth/0/def/%286%20Jan%29VALUES/.T/.gridvalues/dup/length/4/sub/get/last/RANGE/T/name/npts/NewIntegerGRID//units/%281/3%20months%20since%202008-01-01%29def/replaceGRID/DATA/5.0/45.0/RANGE/dup/T/1/108/RANGE/T/0/36/72/shiftdata/T//modulus/36/def/pop/exch/T/-108/shiftGRID/T/1/last/RANGE/T//modulus/36/def/pop//fullname/%282011%29def/exch/a:/T_lag/72/VALUE/T_lag/removeGRID//fullname/%282010%29def/:a:/T_lag/36/VALUE/T_lag/removeGRID//fullname/%282009%29def/:a:/T_lag/0/VALUE/T_lag/removeGRID//fullname/%282008%29def/:a/T/fig:/medium/line/verythin/blue/solid/line/magenta/line/grey/line/:fig//plotaxislength/250/psdef/figviewer.html?my.help=&map.url=&map.domainparam=+/plotaxislength+250+psdef+/plotborder+72+psdef&map.zoom=Zoom&map.plotaxislength=432&map.plotborder=72&map.fnt=Helvetica&map.fntsze=12&map.color_smoothing=1&map.XOVY=auto&map.iftime=25&map.mftime=25&map.fftime=200" OnMouseOver="self.status='Click here to modify graph';return true">

<img src="/<INGRID> dup dataseturl</INGRID>/T/2/copy//pointwidth/0/def/%286%20Jan%29VALUES/.T/.gridvalues/dup/length/4/sub/get/last/RANGE/T/name/npts/NewIntegerGRID//units/%281/3%20months%20since%202008-01-01%29def/replaceGRID/DATA/5.0/45.0/RANGE/dup/T/1/108/RANGE/T/0/36/72/shiftdata/T//modulus/36/def/pop/exch/T/-108/shiftGRID/T/1/last/RANGE/T//modulus/36/def/pop//fullname/%282011%29def/exch/a:/T_lag/72/VALUE/T_lag/removeGRID//fullname/%282010%29def/:a:/T_lag/36/VALUE/T_lag/removeGRID//fullname/%282009%29def/:a:/T_lag/0/VALUE/T_lag/removeGRID//fullname/%282008%29def/:a/T/fig:/medium/line/verythin/blue/solid/line/magenta/line/grey/line/:fig//plotaxislength/250/psdef/+/T/0.5/36.5/plotrange+//plotborder+72+psdef//plotbordertop+15+psdef//plotborderbottom+62+psdef//plotaxislength+250+psdef//XOVY+null+psdef+.gif" NOSAVE border=0 ALT="Multi-year temperature comparison" title="Multi-year temperature comparison" width=322 height=197></a>

</center>


</td><td bgcolor="#F0F8FF" width="50%">
<font face="Helvetical,Arial" point-size=9pt size=-1>
<b>d) </b><br>
</font>

<center>

<a href="/<INGRID> dup dataseturl</INGRID>/DATA/null/null/RANGE//plotlast/200/def//fullname/%28Temperature%29def/<INGRID> 1 index dataseturl </INGRID>%5BT%5D2/SM121/T/2/index/.T/a:/.first/cvsunits/:a:/.last/cvsunits/:a/RANGE/T/2/index/.T/replaceGRID//fullname/%281979-2008%20Average%29def/2/copy/maskgt/1/index/T/fig:/blue/deltabars/brown/deltabars/|/black/line/grey/line/:fig/figviewer.html?my.help=more+options&map.url=&map.domain=+%7B+/T+last+365.+sub+last+plotrange+%7D&map.domainparam=+/plotaxislength+250+psdef+/plotborder+72+psdef+/XOVY+null+psdef&map.zoom=Zoom&map.temp.plotfirst=5.0&map.T.plotfirst=last+3650.+sub&map.T.units=days+since+1960-01-01&map.T.plotlast=&map.plotaxislength=432" OnMouseOver="self.status='Click here to explore the data';return true">

<img src="/<INGRID> dup dataseturl</INGRID>/DATA/null/null/RANGE//plotlast/45.0/def//fullname/%28Temperature%29def/<INGRID> 1 index dataseturl </INGRID>%5BT%5D2/SM121/T/2/index/.T/a:/.first/cvsunits/:a:/.last/cvsunits/:a/RANGE/T/2/index/.T/replaceGRID//fullname/%281979-2008%20Average%29def/2/copy/maskgt/1/index/T/fig:/blue/deltabars/brown/deltabars/|/black/line/grey/line/:fig/+/T/last/365./sub/last/plotrange+//plotborder+72+psdef//plotbordertop+20+psdef//plotborderbottom+62+psdef//plotaxislength+250+psdef//XOVY+null+psdef+.gif" NOSAVE border=0 ALT="Observed vs. average temperature for past year" title="Observed vs. average temperature for past year" width=322 height=197></a>


</center>

</td></tr><tr valign="top"><td colspan="2" bgcolor="#F0F8FF">
<font face="Helvetical,Arial" point-size=12pt size=-1>
<b><u>Description</u></b>
</font>
<font face="Helvetical,Arial" point-size=9pt size=-1>
<br>
a) Dekadal (i.e., ~10-day) average temperature for the selected region for the past ten years.  
<p>
b) Same as (a) (solid black line) with the addition of the 1979-2008 average temperature for the same region (grey dotted line).  The blue (red) bars are indicative of temperatures that are above (below) the 1979-2008 average.
<p>
c) Same as (a) for the current year (thick black line), as indicated by the axis labels. 
Temperature from previous years are also shown (blue-1 yr from present; magenta-
2 yrs from present; grey-3 yrs from present). 
<p>
d) Dekadal temperature (solid black line) and the 1979-2008 average temperature (grey dotted line) for the same region for the past year.   
<p>
<font face="Helvetical,Arial" point-size=12pt size=-1>
<b><u>Data Sources</u></b>
<br></font>
<font face="Helvetical,Arial" point-size=9pt size=-1>
<b>Temperature</b><br>
<font size=-1><b>Data</b>:&nbsp;&nbsp;Reanalysis temperature at 1000 hPa regridded to a 0.1 x 0.1 deg. lat/lon grid</font>
<br><font size=-1><b>Data Source</b>:&nbsp; NCEP/NCAR Reanalysis 
(<a href="http://iridl.ldeo.columbia.edu/SOURCES/.NOAA/.NCEP-NCAR/.dataset_documentation.html">NCEP/NCAR Reanalysis</a>) </font>
<p>
<b>Temperature 1979-2008 Climatology</b><br>
<font size=-1><b>Data</b>: Reanalysis temperature at 1000 hPa regridded to a 0.1 x 0.1 deg. lat/lon grid</font>
<br><font size=-1><b>Base Period</b>: 1 Jan 1979 to 31 Dec 2008</font>
<br><font size=-1><b>Data Source</b>: NCEP/NCAR Reanalysis 
(<a href="http://iridl.ldeo.columbia.edu/SOURCES/.NOAA/.NCEP-NCAR/.dataset_documentation.html">NCEP/NCAR Reanalysis</a>) </font>
<p>

</td></tr></tbody></table>
</td></tr></tbody></table>
</center></body></html>






